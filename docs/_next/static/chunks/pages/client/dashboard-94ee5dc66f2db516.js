(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[170],{7284:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/client/dashboard",function(){return t(2959)}])},2959:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return o}});var a=t(5893),l=t(7294),n=t(1664),r=t.n(n),i=t(6167),c=t(4816);function d(e){let{value:s}=e;return(0,a.jsx)("div",{className:"h-1.5 rounded-full bg-slate-800 overflow-hidden",children:(0,a.jsx)("div",{className:"h-full bg-emerald-500 transition-all",style:{width:"".concat(Math.min(100,Math.max(0,s)),"%")}})})}function o(){let{isAuthenticated:e}=(0,i.a)(),{milestones:s,manpower:t,shutdowns:n,equipment:o,notifications:x,markNotificationRead:m,addShutdownEvent:u}=(0,c.r)(),[p,h]=(0,l.useState)("overview"),[j,b]=(0,l.useState)(t),[f,v]=(0,l.useState)({title:"",type:"Planned",date:""}),[g,N]=(0,l.useState)(null),[y,w]=(0,l.useState)("All"),k=x.filter(e=>!e.read).length,A=(0,l.useMemo)(()=>"All"===y?o:o.filter(e=>e.category===y),[o,y]),M=(0,l.useMemo)(()=>s.length?Math.round(s.reduce((e,s)=>e+s.progress,0)/s.length):0,[s]),C=(e,s)=>{b(t=>t.map(t=>{if(t.id!==e)return t;let a=Math.min(t.countAvailable,Math.max(0,t.countAssigned+s));return{...t,countAssigned:a}}))};return e?(0,a.jsxs)("div",{className:"space-y-6 text-sm text-slate-200",children:[(0,a.jsxs)("header",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-semibold text-slate-50 mb-1",children:"Client Project Dashboard"}),(0,a.jsx)("p",{className:"text-slate-300",children:"Real-time view of project milestones, manpower deployment, shutdown planning, and equipment erection progress."})]}),(0,a.jsxs)("div",{className:"card-surface px-4 py-2 flex items-center gap-4 text-xs",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-slate-400",children:"Overall Progress"}),(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsxs)("span",{className:"text-lg font-semibold text-emerald-400",children:[M,"%"]})})]}),(0,a.jsx)("div",{className:"w-32",children:(0,a.jsx)(d,{value:M})})]})]}),(0,a.jsx)("nav",{className:"flex flex-wrap gap-2 text-xs",children:[{key:"overview",label:"Project Overview"},{key:"manpower",label:"Manpower Scheduling"},{key:"maintenance",label:"Maintenance & Shutdowns"},{key:"equipment",label:"Equipment Monitoring"},{key:"notifications",label:k?"Notifications (".concat(k,")"):"Notifications"}].map(e=>(0,a.jsx)("button",{onClick:()=>h(e.key),className:"px-3 py-1.5 rounded-full border text-xs transition-colors ".concat(p===e.key?"bg-accent-500 text-slate-950 border-accent-500":"border-slate-700 text-slate-300 hover:border-accent-500/70 hover:text-accent-100"),children:e.label},e.key))}),"overview"===p&&(0,a.jsxs)("section",{className:"grid gap-5 lg:grid-cols-[3fr,2fr] items-start",children:[(0,a.jsxs)("div",{className:"card-surface p-5 space-y-4",children:[(0,a.jsx)("h2",{className:"text-base font-semibold text-slate-50 mb-1",children:"Project Milestones"}),(0,a.jsx)("div",{className:"space-y-3",children:s.map(e=>(0,a.jsxs)("div",{className:"border border-slate-800 rounded-md p-3",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,a.jsx)("div",{className:"text-slate-100 text-sm font-semibold",children:e.name}),(0,a.jsx)("span",{className:"pill text-xs",children:"completed"===e.status?"Completed":"in_progress"===e.status?"In Progress":"Not Started"})]}),(0,a.jsxs)("div",{className:"flex justify-between text-xs text-slate-400 mb-1",children:[(0,a.jsxs)("span",{children:["Planned: ",e.plannedDate]}),e.actualDate&&(0,a.jsxs)("span",{children:["Actual: ",e.actualDate]})]}),(0,a.jsx)(d,{value:e.progress})]},e.id))})]}),(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsxs)("div",{className:"card-surface p-4",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-slate-50 mb-2",children:"Manpower Snapshot"}),(0,a.jsx)("div",{className:"space-y-2 text-xs",children:j.map(e=>{let s=0===e.countAvailable?0:Math.round(e.countAssigned/e.countAvailable*100);return(0,a.jsxs)("div",{className:"border border-slate-800 rounded-md p-2",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,a.jsx)("span",{className:"text-slate-100",children:e.trade}),(0,a.jsxs)("span",{className:"text-slate-300",children:[e.countAssigned,"/",e.countAvailable," assigned"]})]}),(0,a.jsx)(d,{value:s})]},e.id)})})]})})]}),"manpower"===p&&(0,a.jsxs)("section",{className:"card-surface p-5 space-y-4",children:[(0,a.jsx)("h2",{className:"text-base font-semibold text-slate-50",children:"Manpower Scheduling & Availability"}),(0,a.jsx)("p",{className:"text-xs text-slate-300 max-w-2xl",children:"Adjust on-site deployment for welders, fitters, riggers, and supervisors based on current project priorities. Counts below update in real time for this session."}),(0,a.jsx)("div",{className:"grid gap-3 md:grid-cols-2",children:j.map(e=>{let s=0===e.countAvailable?0:Math.round(e.countAssigned/e.countAvailable*100);return(0,a.jsxs)("div",{className:"border border-slate-800 rounded-md p-3 space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"font-semibold text-slate-100",children:e.trade}),(0,a.jsxs)("span",{className:"text-xs text-slate-400",children:[e.countAssigned,"/",e.countAvailable," assigned"]})]}),(0,a.jsx)(d,{value:s}),(0,a.jsxs)("div",{className:"flex gap-2 text-xs",children:[(0,a.jsx)("button",{type:"button",onClick:()=>C(e.id,-1),className:"px-2 py-1 rounded-md border border-slate-700 text-slate-200 hover:border-accent-500/70",children:"- Remove"}),(0,a.jsx)("button",{type:"button",onClick:()=>C(e.id,1),className:"px-2 py-1 rounded-md border border-slate-700 text-slate-200 hover:border-emerald-500/70",children:"+ Assign"})]})]},e.id)})})]}),"maintenance"===p&&(0,a.jsxs)("section",{className:"grid gap-5 lg:grid-cols-[2fr,3fr] items-start",children:[(0,a.jsxs)("div",{className:"card-surface p-5 space-y-3",children:[(0,a.jsx)("h2",{className:"text-base font-semibold text-slate-50",children:"Maintenance & Shutdown Scheduler"}),(0,a.jsx)("p",{className:"text-xs text-slate-300",children:"Plan annual shutdowns and log emergency repair events. Entries appear immediately in the shutdown list and trigger notifications."}),(0,a.jsxs)("div",{className:"space-y-3 text-xs",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-[11px] mb-1 text-slate-300",children:["Title ",(0,a.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,a.jsx)("input",{type:"text",className:"w-full rounded-md bg-slate-900 border border-slate-700 px-3 py-2 text-xs focus:outline-none focus:ring-1 focus:ring-accent-500",value:f.title,onChange:e=>v(s=>({...s,title:e.target.value})),placeholder:"e.g. Annual Maintenance â€“ Boiler #2"})]}),(0,a.jsxs)("div",{className:"grid gap-3 sm:grid-cols-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-[11px] mb-1 text-slate-300",children:["Date ",(0,a.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,a.jsx)("input",{type:"date",className:"w-full rounded-md bg-slate-900 border border-slate-700 px-3 py-2 text-xs focus:outline-none focus:ring-1 focus:ring-accent-500",value:f.date,onChange:e=>v(s=>({...s,date:e.target.value}))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-[11px] mb-1 text-slate-300",children:"Type"}),(0,a.jsxs)("select",{className:"w-full rounded-md bg-slate-900 border border-slate-700 px-3 py-2 text-xs focus:outline-none focus:ring-1 focus:ring-accent-500",value:f.type,onChange:e=>v(s=>({...s,type:e.target.value})),children:[(0,a.jsx)("option",{value:"Planned",children:"Planned"}),(0,a.jsx)("option",{value:"Emergency",children:"Emergency"})]})]})]}),g&&(0,a.jsx)("p",{className:"text-[11px] text-red-400",children:g}),(0,a.jsx)("button",{type:"button",onClick:()=>{if(!f.title.trim()||!f.date){N("Enter a title and date for the shutdown or repair.");return}N(null),u({title:f.title.trim(),type:f.type,date:f.date}),v({title:"",type:f.type,date:""})},className:"inline-flex items-center justify-center px-4 py-2 rounded-md bg-accent-500 text-slate-950 font-semibold text-xs hover:bg-accent-500/90",children:"Add to Calendar"})]})]}),(0,a.jsxs)("div",{className:"card-surface p-5 space-y-3",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-slate-50 mb-1",children:"Shutdown & Repair Calendar"}),(0,a.jsx)("div",{className:"space-y-2 text-xs max-h-80 overflow-y-auto pr-1",children:n.map(e=>(0,a.jsxs)("div",{className:"border border-slate-800 rounded-md p-3 flex flex-col gap-1",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-slate-100",children:e.title}),(0,a.jsx)("span",{className:"pill text-[10px] ".concat("Emergency"===e.type?"border-red-500/70 text-red-300":"border-amber-400/70 text-amber-200"),children:e.type})]}),(0,a.jsxs)("div",{className:"flex justify-between text-[11px] text-slate-400",children:[(0,a.jsx)("span",{children:e.date}),(0,a.jsx)("span",{children:e.status})]})]},e.id))})]})]}),"equipment"===p&&(0,a.jsxs)("section",{className:"card-surface p-5 space-y-4",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-base font-semibold text-slate-50",children:"Equipment Monitoring"}),(0,a.jsx)("p",{className:"text-xs text-slate-300 max-w-xl",children:"Track fabrication and erection progress for boilers, dryers, tanks, and heavy structures across your project."})]}),(0,a.jsxs)("div",{className:"text-xs",children:[(0,a.jsx)("label",{className:"mr-2 text-slate-300",children:"Filter by category"}),(0,a.jsxs)("select",{className:"rounded-md bg-slate-900 border border-slate-700 px-2 py-1 text-xs focus:outline-none focus:ring-1 focus:ring-accent-500",value:y,onChange:e=>w("All"===e.target.value?"All":e.target.value),children:[(0,a.jsx)("option",{value:"All",children:"All"}),(0,a.jsx)("option",{value:"Boiler",children:"Boiler"}),(0,a.jsx)("option",{value:"Dryer",children:"Dryer"}),(0,a.jsx)("option",{value:"Tank",children:"Tank"}),(0,a.jsx)("option",{value:"Structure",children:"Structure"})]})]})]}),(0,a.jsx)("div",{className:"grid gap-3 md:grid-cols-2",children:A.map(e=>(0,a.jsxs)("div",{className:"border border-slate-800 rounded-md p-3 text-xs space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-slate-100 font-semibold",children:e.name}),(0,a.jsx)("div",{className:"text-slate-400",children:e.location})]}),(0,a.jsx)("span",{className:"pill text-[10px]",children:e.category})]}),(0,a.jsxs)("div",{className:"flex justify-between text-[11px] text-slate-400",children:[(0,a.jsxs)("span",{children:["Status: ",e.status]}),(0,a.jsxs)("span",{children:[e.progress,"%"]})]}),(0,a.jsx)(d,{value:e.progress})]},e.id))})]}),"notifications"===p&&(0,a.jsxs)("section",{className:"card-surface p-5 space-y-3",children:[(0,a.jsx)("h2",{className:"text-base font-semibold text-slate-50",children:"Notifications"}),(0,a.jsx)("p",{className:"text-xs text-slate-300",children:"Real-time alerts for project updates, inquiries, maintenance events, and system status."}),(0,a.jsx)("div",{className:"space-y-2 text-xs max-h-80 overflow-y-auto pr-1",children:x.map(e=>(0,a.jsxs)("div",{className:"border rounded-md p-3 flex justify-between items-start gap-3 ".concat(e.read?"border-slate-800 bg-slate-950/70":"border-accent-500/50"),children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"mb-1 text-slate-100",children:e.message}),(0,a.jsx)("div",{className:"text-[11px] text-slate-500",children:e.timestamp})]}),!e.read&&(0,a.jsx)("button",{type:"button",onClick:()=>m(e.id),className:"text-[11px] text-accent-300 hover:text-accent-100",children:"Mark read"})]},e.id))})]})]}):(0,a.jsxs)("div",{className:"max-w-xl mx-auto card-surface p-6 text-sm text-slate-200",children:[(0,a.jsx)("h1",{className:"text-2xl font-semibold text-slate-50 mb-2",children:"Client Dashboard"}),(0,a.jsx)("p",{className:"mb-3 text-slate-300",children:"This area is restricted to MM Project Engineers clients. Please sign in to view real-time project updates, manpower status, maintenance calendar, and equipment progress."}),(0,a.jsx)(r(),{href:"/login",className:"inline-flex items-center justify-center px-4 py-2 rounded-md bg-accent-500 text-slate-950 font-semibold text-xs hover:bg-accent-500/90",children:"Go to Login"})]})}}},function(e){e.O(0,[774,888,179],function(){return e(e.s=7284)}),_N_E=e.O()}]);